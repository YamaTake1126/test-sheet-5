<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚´ãƒ«ãƒ•ã‚¯ãƒ©ãƒ–è©•ä¾¡ï¼ˆé…å¸ƒç”¨ãƒ»è©•ä¾¡ãƒ¢ãƒ¼ãƒ‰å›ºå®šï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:system-ui,sans-serif;
  margin:8px;
  background:#f2f2f2;
}
h1{
  font-size:18px;
  text-align:center;
}
button{
  font-size:14px;
  padding:8px 10px;
  margin:2px;
}
input[type=text],
input[type=number]{
  font-size:16px;
  padding:6px;
}

.card{
  background:#fff;
  border-radius:8px;
  padding:8px;
  margin-bottom:10px;
  box-shadow:0 1px 3px rgba(0,0,0,.1);
}

.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.topbox{
  background:#fafafa;
  border:1px solid #ddd;
  border-radius:6px;
  padding:6px;
  margin-bottom:6px;
}

.fixed-name{
  font-size:16px;
  font-weight:bold;
  padding:6px;
  background:#eee;
  border-radius:4px;
}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  border:1px solid #ccc;
  padding:6px;
  vertical-align:middle;
}

th{
  background:#eee;
  font-size:16px;
}

td.label{
  font-size:16px;
  font-weight:bold;
  width:25%;
}

td.meaning{
  font-size:14px;
  color:#444;
  width:35%;
}

.input-wrap{
  display:flex;
  align-items:center;
  gap:6px;
}
.input-wrap input{
  flex:1;
}
.input-wrap button{
  width:36px;
  height:36px;
  padding:0;
}

.toggle-btn{
  font-size:13px;
}

/* =====================
   ğŸ“± ã‚¹ãƒãƒ›æœ€é©åŒ–
   ===================== */
@media(max-width:600px){

  h1{font-size:16px;}

  table, tbody, tr, th, td{
    display:block;
    width:100%;
  }

  tr{
    margin-bottom:10px;
    border:1px solid #ddd;
    border-radius:6px;
    padding:6px;
    background:#fafafa;
  }

  th{
    display:none;
  }

  td{
    border:none;
    padding:4px 0;
  }

  td.label{
    font-size:15px;
    width:100%;
  }

  td.meaning{
    font-size:13px;
    width:100%;
    color:#666;
  }

  .input-wrap{
    flex-direction:row;
  }

  .input-wrap button{
    width:40px;
    height:40px;
    font-size:18px;
  }
}
</style>
</head>
<body>

<h1>ã‚´ãƒ«ãƒ•ã‚¯ãƒ©ãƒ–è©•ä¾¡</h1>

<div class="topbox">
  è©•ä¾¡è€…åï¼ˆå¿…é ˆï¼‰<br>
  <div class="input-wrap">
    <input type="text" id="evaluator" placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒ" oninput="saveData()">
    <button onclick="voiceInput('evaluator')">ğŸ¤</button>
  </div>
</div>

<button onclick="exportCSV()">ğŸ“„ CSVå‡ºåŠ›</button>

<div id="samples"></div>

<script>
const SAMPLE_NAMES=[
  "Gâ…¢8 11.5 DR-L(ç¾è¡Œå“)",
  "24AKA 11.5 DR-L SK1-A",
  "24AKA 11.5 DR-L SK1-C"
];

const STORAGE_KEY="golf_eval_fixed";

const items=[
 {key:"dist",label:"é£›è·é›¢",meaning:"1:é£›ã°ãªã„ / 5:é£›ã¶"},
 {key:"easy",label:"æ‰“ã¡ã‚„ã™ã•",meaning:"1:é›£ã—ã„ / 5:æ˜“ã—ã„"},
 {key:"up",label:"ä¸Šã‚Šæ˜“ã•",meaning:"1:ä¸ŠãŒã‚‰ãªã„ / 5:ä¸ŠãŒã‚‹"},
 {key:"launch",label:"æ‰“ã¡å‡ºã—(é«˜ä½)",meaning:"1:ä½ã„ / 5:é«˜ã„"},
 {key:"traj",label:"å¼¾é“ï¼ˆæ˜‡é™è»Œé“ï¼‰",meaning:"1:å¹ã‘ã‚‹ / 5:å¼·ã„"},
 {key:"dir",label:"æ–¹å‘æ€§",meaning:"1:æ‚ªã„ / 5:è‰¯ã„"},
 {key:"dir_launch_ref",label:"æ‰“ã¡å‡ºã—ï¼ˆå·¦å³ï¼‰",meaning:"5:å·¦ / 3:ä¸­ / 1:å³"},
 {key:"dir_traj_ref",label:"å¼¾é“ï¼ˆã‚µã‚¤ãƒ‰ï¼‰",meaning:"5:ãƒ•ãƒƒã‚¯ / 3:ç›´ / 1:ã‚¹ãƒ©ã‚¤ã‚¹"},
 {key:"meet",label:"ãƒŸãƒ¼ãƒˆç‡",meaning:"1:æ‚ªã„ / 5:è‰¯ã„"},
 {key:"swing",label:"æŒ¯ã‚Šã‚„ã™ã•",meaning:"1:æŒ¯ã‚Šã«ãã„ / 5:æŒ¯ã‚Šã‚„ã™ã„"},
 {key:"flex",label:"ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹",meaning:"1:æŸ” / 5:ç¡¬"},
 {key:"balance",label:"ãƒãƒ©ãƒ³ã‚¹",meaning:"1:è»½ / 5:é‡"},
 {key:"grip",label:"ã‚°ãƒªãƒƒãƒ—å¾„",meaning:"1:ç´° / 5:å¤ª"},
 {key:"rank",label:"é †ä½",meaning:"æ•°å­—ãŒå°ã•ã„ã»ã©è‰¯ã„"},
 {key:"comment",label:"ã‚³ãƒ¡ãƒ³ãƒˆ",meaning:"è‡ªç”±è¨˜è¿°"}
];

function addSample(i,name){
  const d=document.createElement("div");
  d.className="card";
  d.innerHTML=`
  <div class="header">
    <strong>ã‚µãƒ³ãƒ—ãƒ« ${i+1}</strong>
    <button class="toggle-btn" onclick="toggleSample(this)">â–² æŠ˜ã‚ŠãŸãŸã‚€</button>
  </div>

  <div class="topbox">
    ã‚µãƒ³ãƒ—ãƒ«å<br>
    <div class="fixed-name">${name}</div>
  </div>

  <div class="content">
    <table>
      <tr><th>é …ç›®</th><th>å…¥åŠ›</th><th>ç›®å®‰</th></tr>
      ${items.map(it=>{
        const id=`s${i}_${it.key}`;
        return`
        <tr>
          <td class="label">${it.label}</td>
          <td>
            <div class="input-wrap">
              ${
                it.key==="comment"
                ? `<input type="text" id="${id}" oninput="saveData()">`
                : `<input type="number" min="1" max="5" step="1" id="${id}" oninput="saveData()">`
              }
              <button onclick="voiceInput('${id}')">ğŸ¤</button>
            </div>
          </td>
          <td class="meaning">${it.meaning}</td>
        </tr>`;
      }).join("")}
    </table>
  </div>`;
  samples.appendChild(d);
}

function toggleSample(b){
  const c=b.closest(".card").querySelector(".content");
  c.style.display=c.style.display==="none"?"":"none";
  b.textContent=c.style.display?"â–¼ é–‹ã":"â–² æŠ˜ã‚ŠãŸãŸã‚€";
}

function voiceInput(id){
  if(!('webkitSpeechRecognition'in window)){
    alert("éŸ³å£°å…¥åŠ›éå¯¾å¿œ");
    return;
  }
  const r=new webkitSpeechRecognition();
  r.lang="ja-JP";
  r.start();
  r.onresult=e=>{
    const t=e.results[0][0].transcript;
    document.getElementById(id).value=t.replace(/[^\d]/g,'')||t;
    saveData();
  };
}

function saveData(){
  const d={evaluator:evaluator.value,samples:[]};
  SAMPLE_NAMES.forEach((n,i)=>{
    const o={name:n};
    items.forEach(it=>{
      const el=document.getElementById(`s${i}_${it.key}`);
      o[it.key]=el?el.value:"";
    });
    d.samples.push(o);
  });
  localStorage.setItem(STORAGE_KEY,JSON.stringify(d));
}

function loadData(){
  SAMPLE_NAMES.forEach(addSample);
  const r=localStorage.getItem(STORAGE_KEY);
  if(!r)return;
  const d=JSON.parse(r);
  evaluator.value=d.evaluator||"";
  d.samples.forEach((s,i)=>{
    items.forEach(it=>{
      const el=document.getElementById(`s${i}_${it.key}`);
      if(el)el.value=s[it.key]||"";
    });
  });
}

function exportCSV(){
  if(!evaluator.value.trim()){alert("è©•ä¾¡è€…åå¿…é ˆ");return;}
  const rows=[];
  rows.push(["è©•ä¾¡è€…","æ—¥æ™‚","ã‚µãƒ³ãƒ—ãƒ«å",...items.map(i=>i.label)]);
  const now=new Date().toLocaleString();
  SAMPLE_NAMES.forEach((n,i)=>{
    const r=[evaluator.value,now,n];
    items.forEach(it=>r.push(document.getElementById(`s${i}_${it.key}`).value));
    rows.push(r);
  });
  const csv="\uFEFF"+rows.map(r=>r.map(v=>`"${v}"`).join(",")).join("\n");
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
  a.download="golf_eval.csv";
  a.click();
}

loadData();
</script>

</body>
</html>

